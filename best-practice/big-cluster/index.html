<!DOCTYPE html>
<html lang="zh" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.65.3" />
    <meta name="description" content="Kubernetes 实践指南">
<meta name="author" content="roc">

    <link rel="icon" href="/images/favicon.png" type="image/png">

    <title>大规模集群优化 :: Kubernetes 实践指南</title>

    
    <link href="/css/nucleus.css?1583138100" rel="stylesheet">
    <link href="/css/fontawesome-all.min.css?1583138100" rel="stylesheet">
    <link href="/css/hybrid.css?1583138100" rel="stylesheet">
    <link href="/css/featherlight.min.css?1583138100" rel="stylesheet">
    <link href="/css/perfect-scrollbar.min.css?1583138100" rel="stylesheet">
    <link href="/css/auto-complete.css?1583138100" rel="stylesheet">
    <link href="/css/atom-one-dark-reasonable.css?1583138100" rel="stylesheet">
    <link href="/css/theme.css?1583138100" rel="stylesheet">
    <link href="/css/hugo-theme.css?1583138100" rel="stylesheet">
    
      <link href="/css/theme-mine.css?1583138100" rel="stylesheet">
    

    <script src="/js/jquery-3.3.1.min.js?1583138100"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    
  </head>
  <body class="" data-url="/best-practice/big-cluster/">
    <nav id="sidebar" class="showVisitedLinks">



  <div id="header-wrapper">
    <div id="header">
      <a id="logo" href="https://k8s.imroc.io/" style="display:block">
  <div style="width:100%; height:100%;" >
    <img style="width: 50px; height:50px;"
      src="https://blobs.gitbook.com/spaces%2F-LpD0AbLSTB3uW-I8VBQ%2Favatar.png?generation=1569029096804026&alt=media"
      /><div style="height:100%; margin-bottom:3px; font-weight: bold;">Kubernetes 实践指南</div>
  </div>
</a>

    </div>
    
        
<div class="aa-input-container" id="aa-input-container">
    <input type="search" id="aa-search-input" class="aa-input-search" placeholder="搜索..."
        name="search" autocomplete="off" />
    <svg class="aa-input-icon" viewBox="654 -372 1664 1664">
        <path
            d="M1806,332c0-123.3-43.8-228.8-131.5-316.5C1586.8-72.2,1481.3-116,1358-116s-228.8,43.8-316.5,131.5  C953.8,103.2,910,208.7,910,332s43.8,228.8,131.5,316.5C1129.2,736.2,1234.7,780,1358,780s228.8-43.8,316.5-131.5  C1762.2,560.8,1806,455.3,1806,332z M2318,1164c0,34.7-12.7,64.7-38,90s-55.3,38-90,38c-36,0-66-12.7-90-38l-343-342  c-119.3,82.7-252.3,124-399,124c-95.3,0-186.5-18.5-273.5-55.5s-162-87-225-150s-113-138-150-225S654,427.3,654,332  s18.5-186.5,55.5-273.5s87-162,150-225s138-113,225-150S1262.7-372,1358-372s186.5,18.5,273.5,55.5s162,87,225,150s113,138,150,225  S2062,236.7,2062,332c0,146.7-41.3,279.7-124,399l343,343C2305.7,1098.7,2318,1128.7,2318,1164z" />
    </svg>
</div>


<script type="text/javascript" src="/js/lunr.min.js?1583138100"></script>
<script type="text/javascript" src="/js/auto-complete.js?1583138100"></script>
<script type="text/javascript">
    
        var baseurl = "https:\/\/k8s.imroc.io\/";
    
</script>




<script>
    var client = algoliasearch("B6Q6PSGUV5", "5b4678e9995fe4211c4fa43ad2ffdab5");
    var index = client.initIndex("kubernetes-practice-guide-zh");
    
    autocomplete('#aa-search-input', {
        hint: false
    }, {
        source: autocomplete.sources.hits(index, {
            hitsPerPage: 10
        }),
        
        displayKey: 'name',
        
        templates: {
            
            suggestion: function (suggestion) {
                return '<a href="/' + suggestion.uri + '">' + suggestion._highlightResult.title
                    .value + '</a>';
            }
        }
    });
</script>
    
  </div>

    <div class="highlightable">
    <ul class="topics">

        
          
          


 
  
    
    <li data-nav-id="/deploy/" title="部署指南" class="dd-item 
        
        
        
        ">
      <a href="/deploy/">
          部署指南
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/deploy/kubeadm/" title="使用 kubeadm 部署集群" class="dd-item 
        
        
        
        ">
      <a href="/deploy/kubeadm/">
          使用 kubeadm 部署集群
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/deploy/manual/" title="手工部署" class="dd-item 
        
        
        
        ">
      <a href="/deploy/manual/">
          手工部署
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/deploy/manual/prepare/" title="部署前的准备工作" class="dd-item ">
        <a href="/deploy/manual/prepare/">
        部署前的准备工作
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/deploy/manual/bootstrapping-etcd/" title="部署 ETCD" class="dd-item ">
        <a href="/deploy/manual/bootstrapping-etcd/">
        部署 ETCD
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/deploy/manual/bootstrapping-master/" title="部署 Master" class="dd-item ">
        <a href="/deploy/manual/bootstrapping-master/">
        部署 Master
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/deploy/manual/bootstrapping-worker-nodes/" title="部署 Worker 节点" class="dd-item ">
        <a href="/deploy/manual/bootstrapping-worker-nodes/">
        部署 Worker 节点
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/deploy/manual/deploy-critical-addons/" title="部署关键组件" class="dd-item ">
        <a href="/deploy/manual/deploy-critical-addons/">
        部署关键组件
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/deploy/addons/" title="部署附加组件" class="dd-item 
        
        
        
        ">
      <a href="/deploy/addons/">
          部署附加组件
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/deploy/addons/kube-proxy/" title="以 Daemonset 方式部署 kube-proxy" class="dd-item ">
        <a href="/deploy/addons/kube-proxy/">
        以 Daemonset 方式部署 kube-proxy
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/deploy/addons/coredns/" title="部署 CoreDNS" class="dd-item ">
        <a href="/deploy/addons/coredns/">
        部署 CoreDNS
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/deploy/appendix/" title="附录" class="dd-item 
        
        
        
        ">
      <a href="/deploy/appendix/">
          附录
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/deploy/appendix/install-kubectl/" title="安装 kubectl" class="dd-item ">
        <a href="/deploy/appendix/install-kubectl/">
        安装 kubectl
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/best-practice/" title="最佳实践" class="dd-item 
        parent
        
        
        ">
      <a href="/best-practice/">
          最佳实践
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/best-practice/deploy/" title="应用部署最佳实践" class="dd-item 
        
        
        
        ">
      <a href="/best-practice/deploy/">
          应用部署最佳实践
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/best-practice/deploy/use-pdb-to-avoid-service-unavailable-during-eviction/" title="使用 PodDisruptionBudget 避免驱逐导致服务不可用" class="dd-item ">
        <a href="/best-practice/deploy/use-pdb-to-avoid-service-unavailable-during-eviction/">
        使用 PodDisruptionBudget 避免驱逐导致服务不可用
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/best-practice/deploy/smooth-update-using-prestophook-and-readinessprobe/" title="使用 preStopHook 和 readinessProbe 保证服务平滑更新不中断" class="dd-item ">
        <a href="/best-practice/deploy/smooth-update-using-prestophook-and-readinessprobe/">
        使用 preStopHook 和 readinessProbe 保证服务平滑更新不中断
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/best-practice/deploy/use-antiaffinity-to-avoid-single-points-of-failure/" title="使用反亲和性避免单点故障" class="dd-item ">
        <a href="/best-practice/deploy/use-antiaffinity-to-avoid-single-points-of-failure/">
        使用反亲和性避免单点故障
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/best-practice/deploy/scale-keepalive-service/" title="解决长连接服务扩容失效" class="dd-item ">
        <a href="/best-practice/deploy/scale-keepalive-service/">
        解决长连接服务扩容失效
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/best-practice/big-cluster/" title="大规模集群优化" class="dd-item active">
        <a href="/best-practice/big-cluster/">
        大规模集群优化
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/best-practice/shell/" title="实用命令与脚本" class="dd-item 
        
        
        
        ">
      <a href="/best-practice/shell/">
          实用命令与脚本
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/best-practice/shell/node/" title="节点相关脚本" class="dd-item ">
        <a href="/best-practice/shell/node/">
        节点相关脚本
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/best-practice/useful/" title="实用工具和技巧" class="dd-item 
        
        
        
        ">
      <a href="/best-practice/useful/">
          实用工具和技巧
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/best-practice/useful/efficient-kubectl/" title="kubectl 高效技巧" class="dd-item ">
        <a href="/best-practice/useful/efficient-kubectl/">
        kubectl 高效技巧
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/best-practice/useful/yaml/" title="实用 yaml 片段" class="dd-item ">
        <a href="/best-practice/useful/yaml/">
        实用 yaml 片段
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/best-practice/useful/shell/" title="实用命令与脚本" class="dd-item ">
        <a href="/best-practice/useful/shell/">
        实用命令与脚本
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/best-practice/node-local-dns/" title="本地 DNS 缓存" class="dd-item ">
        <a href="/best-practice/node-local-dns/">
        本地 DNS 缓存
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/best-practice/wildcard-domain-forward/" title="泛域名转发" class="dd-item ">
        <a href="/best-practice/wildcard-domain-forward/">
        泛域名转发
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/best-practice/permission/" title="集群权限控制" class="dd-item 
        
        
        
        ">
      <a href="/best-practice/permission/">
          集群权限控制
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/best-practice/permission/create-user-using-csr-api/" title="利用 CSR API 创建用户" class="dd-item ">
        <a href="/best-practice/permission/create-user-using-csr-api/">
        利用 CSR API 创建用户
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/best-practice/permission/app/" title="控制应用权限" class="dd-item ">
        <a href="/best-practice/permission/app/">
        控制应用权限
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/best-practice/permission/user/" title="控制用户权限" class="dd-item ">
        <a href="/best-practice/permission/user/">
        控制用户权限
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/best-practice/cert-management/" title="集群证书管理" class="dd-item 
        
        
        
        ">
      <a href="/best-practice/cert-management/">
          集群证书管理
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/best-practice/cert-management/autogenerate-certificate-with-cert-manager/" title="使用 cert-manager 自动生成证书" class="dd-item ">
        <a href="/best-practice/cert-management/autogenerate-certificate-with-cert-manager/">
        使用 cert-manager 自动生成证书
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/best-practice/cert-management/install-cert-manger/" title="安装 cert-manager" class="dd-item ">
        <a href="/best-practice/cert-management/install-cert-manger/">
        安装 cert-manager
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/best-practice/configuration-management/" title="集群配置管理" class="dd-item 
        
        
        
        ">
      <a href="/best-practice/configuration-management/">
          集群配置管理
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/best-practice/configuration-management/helm/" title="Helm" class="dd-item 
        
        
        
        ">
      <a href="/best-practice/configuration-management/helm/">
          Helm
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/best-practice/configuration-management/helm/upgrade-helm-v2-to-v3/" title="Helm V2 迁移到 V3" class="dd-item ">
        <a href="/best-practice/configuration-management/helm/upgrade-helm-v2-to-v3/">
        Helm V2 迁移到 V3
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/best-practice/configuration-management/helm/install-helm/" title="安装 Helm" class="dd-item ">
        <a href="/best-practice/configuration-management/helm/install-helm/">
        安装 Helm
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/cluster/" title="集群方案" class="dd-item 
        
        
        
        ">
      <a href="/cluster/">
          集群方案
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/cluster/ingress/" title="Ingress 方案" class="dd-item 
        
        
        
        ">
      <a href="/cluster/ingress/">
          Ingress 方案
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/cluster/ingress/nginx/" title="Nginx Ingress" class="dd-item 
        
        
        
        ">
      <a href="/cluster/ingress/nginx/">
          Nginx Ingress
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/cluster/ingress/nginx/install-nginx-ingress/" title="安装 nginx ingress controller" class="dd-item ">
        <a href="/cluster/ingress/nginx/install-nginx-ingress/">
        安装 nginx ingress controller
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/cluster/ingress/traefik/" title="Traefik Ingress" class="dd-item 
        
        
        
        ">
      <a href="/cluster/ingress/traefik/">
          Traefik Ingress
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/cluster/ingress/traefik/install-traefik-ingress/" title="安装 traefik ingress controller" class="dd-item ">
        <a href="/cluster/ingress/traefik/install-traefik-ingress/">
        安装 traefik ingress controller
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/cluster/metrics/" title="Metrics 方案" class="dd-item 
        
        
        
        ">
      <a href="/cluster/metrics/">
          Metrics 方案
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/cluster/metrics/install-metrics-server/" title="安装 metrics server" class="dd-item ">
        <a href="/cluster/metrics/install-metrics-server/">
        安装 metrics server
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/cluster/network/" title="网络方案" class="dd-item 
        
        
        
        ">
      <a href="/cluster/network/">
          网络方案
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/cluster/network/flannel/" title="Flannel" class="dd-item 
        
        
        
        ">
      <a href="/cluster/network/flannel/">
          Flannel
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/cluster/network/flannel/deploy/" title="部署 Flannel" class="dd-item ">
        <a href="/cluster/network/flannel/deploy/">
        部署 Flannel
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/cluster/network/understanding/" title="彻底理解集群网络" class="dd-item ">
        <a href="/cluster/network/understanding/">
        彻底理解集群网络
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/cluster/runtime/" title="运行时方案" class="dd-item 
        
        
        
        ">
      <a href="/cluster/runtime/">
          运行时方案
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/cluster/runtime/containerd/" title="Containerd" class="dd-item 
        
        
        
        ">
      <a href="/cluster/runtime/containerd/">
          Containerd
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/cluster/runtime/containerd/install-containerd/" title="安装 containerd" class="dd-item ">
        <a href="/cluster/runtime/containerd/install-containerd/">
        安装 containerd
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/troubleshooting/" title="排错指南" class="dd-item 
        
        
        
        ">
      <a href="/troubleshooting/">
          排错指南
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/troubleshooting/handle/" title="处理实践" class="dd-item 
        
        
        
        ">
      <a href="/troubleshooting/handle/">
          处理实践
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/troubleshooting/handle/arp_cache-overflow/" title="arp_cache 溢出" class="dd-item ">
        <a href="/troubleshooting/handle/arp_cache-overflow/">
        arp_cache 溢出
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/troubleshooting/handle/runnig-out-of-inotify-watches/" title="inotify watch 耗尽" class="dd-item ">
        <a href="/troubleshooting/handle/runnig-out-of-inotify-watches/">
        inotify watch 耗尽
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/troubleshooting/handle/pid-full/" title="PID 耗尽" class="dd-item ">
        <a href="/troubleshooting/handle/pid-full/">
        PID 耗尽
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/troubleshooting/handle/memory-fragmentation/" title="内存碎片化" class="dd-item ">
        <a href="/troubleshooting/handle/memory-fragmentation/">
        内存碎片化
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/troubleshooting/handle/disk-full/" title="磁盘爆满" class="dd-item ">
        <a href="/troubleshooting/handle/disk-full/">
        磁盘爆满
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/troubleshooting/handle/high-load/" title="高负载" class="dd-item ">
        <a href="/troubleshooting/handle/high-load/">
        高负载
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/troubleshooting/trick/" title="排错技巧" class="dd-item 
        
        
        
        ">
      <a href="/troubleshooting/trick/">
          排错技巧
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/troubleshooting/trick/use-systemtap-to-locate-problems/" title="使用 Systemtap 定位疑难杂症" class="dd-item ">
        <a href="/troubleshooting/trick/use-systemtap-to-locate-problems/">
        使用 Systemtap 定位疑难杂症
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/troubleshooting/trick/analysis-exitcode/" title="分析 ExitCode 定位 Pod 异常退出原因" class="dd-item ">
        <a href="/troubleshooting/trick/analysis-exitcode/">
        分析 ExitCode 定位 Pod 异常退出原因
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/troubleshooting/trick/capture-packets-in-container/" title="容器内抓包定位网络问题" class="dd-item ">
        <a href="/troubleshooting/trick/capture-packets-in-container/">
        容器内抓包定位网络问题
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/troubleshooting/cases/" title="案例分享" class="dd-item 
        
        
        
        ">
      <a href="/troubleshooting/cases/">
          案例分享
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/troubleshooting/cases/arp-cache-overflow-causes-healthcheck-failed/" title="ARP 缓存爆满导致健康检查失败" class="dd-item ">
        <a href="/troubleshooting/cases/arp-cache-overflow-causes-healthcheck-failed/">
        ARP 缓存爆满导致健康检查失败
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/troubleshooting/cases/dns-lookup-5s-delay/" title="DNS 5 秒延时" class="dd-item ">
        <a href="/troubleshooting/cases/dns-lookup-5s-delay/">
        DNS 5 秒延时
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/troubleshooting/cases/dns-resolution-abnormal/" title="DNS 解析异常" class="dd-item ">
        <a href="/troubleshooting/cases/dns-resolution-abnormal/">
        DNS 解析异常
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/troubleshooting/cases/schemaerror-when-using-kubectl-apply-or-edit/" title="kubectl edit 或者 apply 报 SchemaError" class="dd-item ">
        <a href="/troubleshooting/cases/schemaerror-when-using-kubectl-apply-or-edit/">
        kubectl edit 或者 apply 报 SchemaError
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/troubleshooting/cases/low-cps-from-lb-to-nodeport/" title="LB 压测 NodePort CPS 低" class="dd-item ">
        <a href="/troubleshooting/cases/low-cps-from-lb-to-nodeport/">
        LB 压测 NodePort CPS 低
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/troubleshooting/cases/livenesprobe-failed-occasionally/" title="Pod 偶尔存活检查失败" class="dd-item ">
        <a href="/troubleshooting/cases/livenesprobe-failed-occasionally/">
        Pod 偶尔存活检查失败
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/troubleshooting/cases/high-legacy-from-pod-to-another-apiserver/" title="Pod 访问另一个集群的 apiserver 有延时" class="dd-item ">
        <a href="/troubleshooting/cases/high-legacy-from-pod-to-another-apiserver/">
        Pod 访问另一个集群的 apiserver 有延时
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/troubleshooting/cases/kubernetes-overflow-and-drop/" title="神秘的溢出与丢包" class="dd-item ">
        <a href="/troubleshooting/cases/kubernetes-overflow-and-drop/">
        神秘的溢出与丢包
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/troubleshooting/cases/lb-with-local-externaltrafficpolicy-timeout-occasionally/" title="访问 externalTrafficPolicy 为 Local 的 Service 对应 LB 有时超时" class="dd-item ">
        <a href="/troubleshooting/cases/lb-with-local-externaltrafficpolicy-timeout-occasionally/">
        访问 externalTrafficPolicy 为 Local 的 Service 对应 LB 有时超时
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/troubleshooting/cases/no-route-to-host/" title="诡异的 No route to host" class="dd-item ">
        <a href="/troubleshooting/cases/no-route-to-host/">
        诡异的 No route to host
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/troubleshooting/cases/cross-vpc-connect-nodeport-timeout/" title="跨 VPC 访问 NodePort 经常超时" class="dd-item ">
        <a href="/troubleshooting/cases/cross-vpc-connect-nodeport-timeout/">
        跨 VPC 访问 NodePort 经常超时
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/troubleshooting/cases/eviction-leads-to-service-disruption/" title="驱逐导致服务中断" class="dd-item ">
        <a href="/troubleshooting/cases/eviction-leads-to-service-disruption/">
        驱逐导致服务中断
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/troubleshooting/summary/" title="踩坑总结" class="dd-item 
        
        
        
        ">
      <a href="/troubleshooting/summary/">
          踩坑总结
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/troubleshooting/summary/cgroup-leaking/" title="cgroup 泄露" class="dd-item ">
        <a href="/troubleshooting/summary/cgroup-leaking/">
        cgroup 泄露
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/troubleshooting/summary/conntrack-conflict/" title="conntrack 冲突导致丢包" class="dd-item ">
        <a href="/troubleshooting/summary/conntrack-conflict/">
        conntrack 冲突导致丢包
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/troubleshooting/summary/tcp_tw_recycle-causes-packet-loss/" title="tcp tw recycle 引发丢包" class="dd-item ">
        <a href="/troubleshooting/summary/tcp_tw_recycle-causes-packet-loss/">
        tcp tw recycle 引发丢包
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/troubleshooting/summary/handle-cgroup-oom-in-userspace-with-oom-guard/" title="使用 oom-guard 在用户态处理 cgroup OOM" class="dd-item ">
        <a href="/troubleshooting/summary/handle-cgroup-oom-in-userspace-with-oom-guard/">
        使用 oom-guard 在用户态处理 cgroup OOM
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/troubleshooting/problems/" title="问题排查" class="dd-item 
        
        
        
        ">
      <a href="/troubleshooting/problems/">
          问题排查
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/troubleshooting/problems/pod/" title="Pod 排错" class="dd-item 
        
        
        
        ">
      <a href="/troubleshooting/problems/pod/">
          Pod 排错
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/troubleshooting/problems/pod/slow-terminating/" title="Pod Terminating 慢" class="dd-item ">
        <a href="/troubleshooting/problems/pod/slow-terminating/">
        Pod Terminating 慢
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/troubleshooting/problems/pod/keep-containercreating-or-waiting/" title="Pod 一直处于 ContainerCreating 或 Waiting 状态" class="dd-item ">
        <a href="/troubleshooting/problems/pod/keep-containercreating-or-waiting/">
        Pod 一直处于 ContainerCreating 或 Waiting 状态
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/troubleshooting/problems/pod/keep-error/" title="Pod 一直处于 Error 状态" class="dd-item ">
        <a href="/troubleshooting/problems/pod/keep-error/">
        Pod 一直处于 Error 状态
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/troubleshooting/problems/pod/keep-imageinspecterror/" title="Pod 一直处于 ImageInspectError 状态" class="dd-item ">
        <a href="/troubleshooting/problems/pod/keep-imageinspecterror/">
        Pod 一直处于 ImageInspectError 状态
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/troubleshooting/problems/pod/keep-imagepullbackoff/" title="Pod 一直处于 ImagePullBackOff 状态" class="dd-item ">
        <a href="/troubleshooting/problems/pod/keep-imagepullbackoff/">
        Pod 一直处于 ImagePullBackOff 状态
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/troubleshooting/problems/pod/keep-pending/" title="Pod 一直处于 Pending 状态" class="dd-item ">
        <a href="/troubleshooting/problems/pod/keep-pending/">
        Pod 一直处于 Pending 状态
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/troubleshooting/problems/pod/keep-terminating/" title="Pod 一直处于 Terminating 状态" class="dd-item ">
        <a href="/troubleshooting/problems/pod/keep-terminating/">
        Pod 一直处于 Terminating 状态
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/troubleshooting/problems/pod/keep-unkown/" title="Pod 一直处于 Unknown 状态" class="dd-item ">
        <a href="/troubleshooting/problems/pod/keep-unkown/">
        Pod 一直处于 Unknown 状态
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/troubleshooting/problems/pod/healthcheck-failed/" title="Pod 健康检查失败" class="dd-item ">
        <a href="/troubleshooting/problems/pod/healthcheck-failed/">
        Pod 健康检查失败
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/troubleshooting/problems/pod/keep-crashloopbackoff/" title="Pod 处于 CrashLoopBackOff 状态" class="dd-item ">
        <a href="/troubleshooting/problems/pod/keep-crashloopbackoff/">
        Pod 处于 CrashLoopBackOff 状态
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/troubleshooting/problems/pod/container-proccess-exit-by-itself/" title="容器进程主动退出" class="dd-item ">
        <a href="/troubleshooting/problems/pod/container-proccess-exit-by-itself/">
        容器进程主动退出
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/troubleshooting/problems/others/" title="其它排错" class="dd-item 
        
        
        
        ">
      <a href="/troubleshooting/problems/others/">
          其它排错
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/troubleshooting/problems/others/job-cannot-delete/" title="Job 无法被删除" class="dd-item ">
        <a href="/troubleshooting/problems/others/job-cannot-delete/">
        Job 无法被删除
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/troubleshooting/problems/others/kubectl-exec-or-logs-failed/" title="kubectl 执行 exec 或 logs 失败" class="dd-item ">
        <a href="/troubleshooting/problems/others/kubectl-exec-or-logs-failed/">
        kubectl 执行 exec 或 logs 失败
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/troubleshooting/problems/others/kernel-solft-lockup/" title="内核软死锁" class="dd-item ">
        <a href="/troubleshooting/problems/others/kernel-solft-lockup/">
        内核软死锁
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/troubleshooting/problems/errors/" title="经典报错" class="dd-item 
        
        
        
        ">
      <a href="/troubleshooting/problems/errors/">
          经典报错
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/troubleshooting/problems/errors/arp_cache-neighbor-table-overflow/" title="arp_cache: neighbor table overflow!" class="dd-item ">
        <a href="/troubleshooting/problems/errors/arp_cache-neighbor-table-overflow/">
        arp_cache: neighbor table overflow!
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/troubleshooting/problems/errors/cannot-allocate-memory/" title="Cannot allocate memory" class="dd-item ">
        <a href="/troubleshooting/problems/errors/cannot-allocate-memory/">
        Cannot allocate memory
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/troubleshooting/problems/errors/no-space-left-on-device/" title="no space left on device" class="dd-item ">
        <a href="/troubleshooting/problems/errors/no-space-left-on-device/">
        no space left on device
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/troubleshooting/problems/network/" title="网络排错" class="dd-item 
        
        
        
        ">
      <a href="/troubleshooting/problems/network/">
          网络排错
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/troubleshooting/problems/network/dns/" title="DNS 解析异常" class="dd-item ">
        <a href="/troubleshooting/problems/network/dns/">
        DNS 解析异常
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/troubleshooting/problems/network/lb-healthcheck-failed/" title="LB 健康检查失败" class="dd-item ">
        <a href="/troubleshooting/problems/network/lb-healthcheck-failed/">
        LB 健康检查失败
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/troubleshooting/problems/network/service-unrecheable/" title="Service 不通" class="dd-item ">
        <a href="/troubleshooting/problems/network/service-unrecheable/">
        Service 不通
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/troubleshooting/problems/network/service-cannot-resolve/" title="Service 无法解析" class="dd-item ">
        <a href="/troubleshooting/problems/network/service-cannot-resolve/">
        Service 无法解析
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/troubleshooting/problems/network/low-throughput/" title="网络性能差" class="dd-item ">
        <a href="/troubleshooting/problems/network/low-throughput/">
        网络性能差
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/troubleshooting/problems/cluster/" title="集群排错" class="dd-item 
        
        
        
        ">
      <a href="/troubleshooting/problems/cluster/">
          集群排错
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/troubleshooting/problems/cluster/daemonset-not-scheduled/" title="Daemonset 没有被调度" class="dd-item ">
        <a href="/troubleshooting/problems/cluster/daemonset-not-scheduled/">
        Daemonset 没有被调度
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/troubleshooting/problems/cluster/node-all-gone/" title="Node 全部消失" class="dd-item ">
        <a href="/troubleshooting/problems/cluster/node-all-gone/">
        Node 全部消失
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/domains/" title="领域应用" class="dd-item 
        
        
        
        ">
      <a href="/domains/">
          领域应用
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/domains/big-data/" title="大数据" class="dd-item 
        
        
        
        ">
      <a href="/domains/big-data/">
          大数据
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/domains/big-data/flink-on-kubernetes/" title="Flink on Kubernetes" class="dd-item ">
        <a href="/domains/big-data/flink-on-kubernetes/">
        Flink on Kubernetes
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/dev/" title="开发指南" class="dd-item 
        
        
        
        ">
      <a href="/dev/">
          开发指南
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/dev/golang-build/" title="Go 语言编译原理与优化" class="dd-item ">
        <a href="/dev/golang-build/">
        Go 语言编译原理与优化
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
         
    </ul>

    
    

    
    <section id="prefooter">
      <hr/>
      <ul>
      
        <li>
          <a class="padding">
            <i class="fas fa-language fa-fw"></i>
          <div class="select-style">
            <select id="select-language" onchange="location = this.value;">
          
          
          
              
              
                  
                    
                    
                      <option id="zh" value="https://k8s.imroc.io/best-practice/big-cluster/" selected>简体中文</option>
                    
                  
              
                  
              
          
        </select>
        <svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
          width="255px" height="255px" viewBox="0 0 255 255" style="enable-background:new 0 0 255 255;" xml:space="preserve">
          <g>
            <g id="arrow-drop-down">
              <polygon points="0,63.75 127.5,191.25 255,63.75 		" />
            </g>
          </g>
        </svg>
        </div>
        </a>
        </li>
      
      
      
        <li><a class="padding" href="#" data-clear-history-toggle=""><i class="fas fa-history fa-fw"></i> 清理历史记录</a></li>
      
      </ul>
    </section>
    
    <section id="footer">
      <center>

    
    <a class="github-button" href="https://github.com/imroc/kubernetes-practice-guide" data-icon="octicon-star"
        data-show-count="true" aria-label="Star imroc/kubernetes-practice-guide on GitHub">Star</a>

    
    <a class="github-button" href="https://github.com/imroc/kubernetes-practice-guide/fork"
        data-icon="octicon-repo-forked" data-show-count="true"
        aria-label="Fork imroc/kubernetes-practice-guide on GitHub">Fork</a>

</center>

<script async defer src="https://buttons.github.io/buttons.js"></script>

    </section>
  </div>
</nav>





        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                  
                  
                  
                  <div id="top-github-link">
                    <a class="github-link" title='编辑当前页' href="https://github.com/imroc/kubernetes-practice-guide/edit/master/content/zh/best-practice/big-cluster.md" target="blank">
                      <i class="fas fa-code-branch"></i>
                      <span id="top-github-link-text">编辑当前页</span>
                    </a>
                  </div>
                  
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            
            
          
          
            <a href='/'>Kubernetes 实践指南</a> > <a href='/best-practice/'>最佳实践</a> > 大规模集群优化
          
         
          
         
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
  <ul>
    <li><a href="#内核参数调优">内核参数调优</a></li>
    <li><a href="#etcd-优化">ETCD 优化</a>
      <ul>
        <li><a href="#高可用部署">高可用部署</a></li>
        <li><a href="#提高磁盘-io-性能">提高磁盘 IO 性能</a></li>
        <li><a href="#提高-etcd-的磁盘-io-优先级">提高 ETCD 的磁盘 IO 优先级</a></li>
        <li><a href="#提高存储配额">提高存储配额</a></li>
        <li><a href="#分离-events-存储">分离 events 存储</a></li>
        <li><a href="#减小网络延迟">减小网络延迟</a></li>
      </ul>
    </li>
    <li><a href="#master-节点配置优化">Master 节点配置优化</a></li>
    <li><a href="#kube-apiserver-优化">kube-apiserver 优化</a>
      <ul>
        <li><a href="#高可用">高可用</a></li>
        <li><a href="#控制连接数">控制连接数</a></li>
      </ul>
    </li>
    <li><a href="#kube-scheduler-与-kube-controller-manager-优化">kube-scheduler 与 kube-controller-manager 优化</a>
      <ul>
        <li><a href="#高可用-1">高可用</a></li>
        <li><a href="#控制-qps">控制 QPS</a></li>
      </ul>
    </li>
    <li><a href="#集群-dns-高可用">集群 DNS 高可用</a></li>
  </ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              大规模集群优化
            </h1>
          

        



<p>Kubernetes 自 v1.6 以来，官方就宣称单集群最大支持 5000 个节点。不过这只是理论上，在具体实践中从 0 到 5000，还是有很长的路要走，需要见招拆招。</p>
<p>官方标准如下：</p>
<ul>
<li>不超过 5000 个节点</li>
<li>不超过 150000 个 pod</li>
<li>不超过 300000 个容器</li>
<li>每个节点不超过 100 个 pod</li>
</ul>
<h2 id="内核参数调优">内核参数调优</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># max-file 表示系统级别的能够打开的文件句柄的数量， 一般如果遇到文件句柄达到上限时，会碰到</span>
<span style="color:#75715e"># &#34;Too many open files&#34; 或者 Socket/File: Can’t open so many files 等错误</span>
fs.file-max<span style="color:#f92672">=</span><span style="color:#ae81ff">1000000</span>

<span style="color:#75715e"># 配置 arp cache 大小</span>
<span style="color:#75715e"># 存在于 ARP 高速缓存中的最少层数，如果少于这个数，垃圾收集器将不会运行。缺省值是 128</span>
net.ipv4.neigh.default.gc_thresh1<span style="color:#f92672">=</span><span style="color:#ae81ff">1024</span>
<span style="color:#75715e"># 保存在 ARP 高速缓存中的最多的记录软限制。垃圾收集器在开始收集前，允许记录数超过这个数字 5 秒。缺省值是 512</span>
net.ipv4.neigh.default.gc_thresh2<span style="color:#f92672">=</span><span style="color:#ae81ff">4096</span>
<span style="color:#75715e"># 保存在 ARP 高速缓存中的最多记录的硬限制，一旦高速缓存中的数目高于此，垃圾收集器将马上运行。缺省值是 1024</span>
net.ipv4.neigh.default.gc_thresh3<span style="color:#f92672">=</span><span style="color:#ae81ff">8192</span>
<span style="color:#75715e"># 以上三个参数，当内核维护的 arp 表过于庞大时候，可以考虑优化</span>

<span style="color:#75715e"># 允许的最大跟踪连接条目，是在内核内存中 netfilter 可以同时处理的“任务”（连接跟踪条目）</span>
net.netfilter.nf_conntrack_max<span style="color:#f92672">=</span><span style="color:#ae81ff">10485760</span>
net.netfilter.nf_conntrack_tcp_timeout_established<span style="color:#f92672">=</span><span style="color:#ae81ff">300</span>
<span style="color:#75715e"># 哈希表大小（只读）（64位系统、8G内存默认 65536，16G翻倍，如此类推）</span>
net.netfilter.nf_conntrack_buckets<span style="color:#f92672">=</span><span style="color:#ae81ff">655360</span>

<span style="color:#75715e"># 每个网络接口接收数据包的速率比内核处理这些包的速率快时，允许送到队列的数据包的最大数目</span>
net.core.netdev_max_backlog<span style="color:#f92672">=</span><span style="color:#ae81ff">10000</span>

<span style="color:#75715e"># 默认值: 128 指定了每一个 real user ID 可创建的 inotify instatnces 的数量上限</span>
fs.inotify.max_user_instances<span style="color:#f92672">=</span><span style="color:#ae81ff">524288</span>
<span style="color:#75715e"># 默认值: 8192 指定了每个inotify instance相关联的watches的上限</span>
fs.inotify.max_user_watches<span style="color:#f92672">=</span><span style="color:#ae81ff">524288</span>
</code></pre></div><h2 id="etcd-优化">ETCD 优化</h2>
<h3 id="高可用部署">高可用部署</h3>
<p>部署一个高可用ETCD集群可以参考官方文档: <a href="https://github.com/etcd-io/etcd/blob/master/Documentation/op-guide/clustering.md">https://github.com/etcd-io/etcd/blob/master/Documentation/op-guide/clustering.md</a></p>
<blockquote>
<p>如果是 self-host 方式部署的集群，可以用 etcd-operator 部署 etcd 集群；也可以使用另一个小集群专门部署 etcd (使用 etcd-operator)</p>
</blockquote>
<h3 id="提高磁盘-io-性能">提高磁盘 IO 性能</h3>
<p>ETCD 对磁盘写入延迟非常敏感，对于负载较重的集群建议磁盘使用 SSD 固态硬盘。可以使用 diskbench 或 fio 测量磁盘实际顺序 IOPS。</p>
<h3 id="提高-etcd-的磁盘-io-优先级">提高 ETCD 的磁盘 IO 优先级</h3>
<p>由于 ETCD 必须将数据持久保存到磁盘日志文件中，因此来自其他进程的磁盘活动可能会导致增加写入时间，结果导致 ETCD 请求超时和临时 leader 丢失。当给定高磁盘优先级时，ETCD 服务可以稳定地与这些进程一起运行:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo ionice -c2 -n0 -p <span style="color:#66d9ef">$(</span>pgrep etcd<span style="color:#66d9ef">)</span>
</code></pre></div><h3 id="提高存储配额">提高存储配额</h3>
<p>默认 ETCD 空间配额大小为 2G，超过 2G 将不再写入数据。通过给 ETCD 配置 <code>--quota-backend-bytes</code> 参数增大空间配额，最大支持 8G。</p>
<h3 id="分离-events-存储">分离 events 存储</h3>
<p>集群规模大的情况下，集群中包含大量节点和服务，会产生大量的 event，这些 event 将会对 etcd 造成巨大压力并占用大量 etcd 存储空间，为了在大规模集群下提高性能，可以将 events 存储在单独的 ETCD 集群中。</p>
<p>配置 kube-apiserver：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">--etcd-servers<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;http://etcd1:2379,http://etcd2:2379,http://etcd3:2379&#34;</span> --etcd-servers-overrides<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/events#http://etcd4:2379,http://etcd5:2379,http://etcd6:2379&#34;</span>
</code></pre></div><h3 id="减小网络延迟">减小网络延迟</h3>
<p>如果有大量并发客户端请求 ETCD leader 服务，则可能由于网络拥塞而延迟处理 follower 对等请求。在 follower 节点上的发送缓冲区错误消息：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">dropped MsgProp to 247ae21ff9436b2d since streamMsg<span style="color:#e6db74">&#39;s sending buffer is full
</span><span style="color:#e6db74">dropped MsgAppResp to 247ae21ff9436b2d since streamMsg&#39;</span>s sending buffer is full
</code></pre></div><p>可以通过在客户端提高 ETCD 对等网络流量优先级来解决这些错误。在 Linux 上，可以使用 tc 对对等流量进行优先级排序：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ tc qdisc add dev eth0 root handle 1: prio bands <span style="color:#ae81ff">3</span>
$ tc filter add dev eth0 parent 1: protocol ip prio <span style="color:#ae81ff">1</span> u32 match ip sport <span style="color:#ae81ff">2380</span> 0xffff flowid 1:1
$ tc filter add dev eth0 parent 1: protocol ip prio <span style="color:#ae81ff">1</span> u32 match ip dport <span style="color:#ae81ff">2380</span> 0xffff flowid 1:1
$ tc filter add dev eth0 parent 1: protocol ip prio <span style="color:#ae81ff">2</span> u32 match ip sport <span style="color:#ae81ff">2379</span> 0xffff flowid 1:1
$ tc filter add dev eth0 parent 1: protocol ip prio <span style="color:#ae81ff">2</span> u32 match ip dport <span style="color:#ae81ff">2379</span> 0xffff flowid 1:1
</code></pre></div><h2 id="master-节点配置优化">Master 节点配置优化</h2>
<p>GCE 推荐配置：</p>
<ul>
<li>1-5 节点: n1-standard-1</li>
<li>6-10 节点: n1-standard-2</li>
<li>11-100 节点: n1-standard-4</li>
<li>101-250 节点: n1-standard-8</li>
<li>251-500 节点: n1-standard-16</li>
<li>超过 500 节点: n1-standard-32</li>
</ul>
<p>AWS 推荐配置：</p>
<ul>
<li>1-5 节点: m3.medium</li>
<li>6-10 节点: m3.large</li>
<li>11-100 节点: m3.xlarge</li>
<li>101-250 节点: m3.2xlarge</li>
<li>251-500 节点: c4.4xlarge</li>
<li>超过 500 节点: c4.8xlarge</li>
</ul>
<p>对应 CPU 和内存为：</p>
<ul>
<li>1-5 节点: 1vCPU 3.75G内存</li>
<li>6-10 节点: 2vCPU 7.5G内存</li>
<li>11-100 节点: 4vCPU 15G内存</li>
<li>101-250 节点: 8vCPU 30G内存</li>
<li>251-500 节点: 16vCPU 60G内存</li>
<li>超过 500 节点: 32vCPU 120G内存</li>
</ul>
<h2 id="kube-apiserver-优化">kube-apiserver 优化</h2>
<h3 id="高可用">高可用</h3>
<ul>
<li>方式一: 启动多个 kube-apiserver 实例通过外部 LB 做负载均衡。</li>
<li>方式二: 设置 <code>--apiserver-count</code> 和 <code>--endpoint-reconciler-type</code>，可使得多个 kube-apiserver 实例加入到 Kubernetes Service 的 endpoints 中，从而实现高可用。</li>
</ul>
<p>不过由于 TLS 会复用连接，所以上述两种方式都无法做到真正的负载均衡。为了解决这个问题，可以在服务端实现限流器，在请求达到阀值时告知客户端退避或拒绝连接，客户端则配合实现相应负载切换机制。</p>
<h3 id="控制连接数">控制连接数</h3>
<p>kube-apiserver 以下两个参数可以控制连接数:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">--max-mutating-requests-inflight int           The maximum number of mutating requests in flight at a given time. When the server exceeds this, it rejects requests. Zero <span style="color:#66d9ef">for</span> no limit. <span style="color:#f92672">(</span>default 200<span style="color:#f92672">)</span>
--max-requests-inflight int                    The maximum number of non-mutating requests in flight at a given time. When the server exceeds this, it rejects requests. Zero <span style="color:#66d9ef">for</span> no limit. <span style="color:#f92672">(</span>default 400<span style="color:#f92672">)</span>
</code></pre></div><p>节点数量在 1000 - 3000 之间时，推荐：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">--max-requests-inflight<span style="color:#f92672">=</span><span style="color:#ae81ff">1500</span>
--max-mutating-requests-inflight<span style="color:#f92672">=</span><span style="color:#ae81ff">500</span>
</code></pre></div><p>节点数量大于 3000 时，推荐：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">--max-requests-inflight<span style="color:#f92672">=</span><span style="color:#ae81ff">3000</span>
--max-mutating-requests-inflight<span style="color:#f92672">=</span><span style="color:#ae81ff">1000</span>
</code></pre></div><h2 id="kube-scheduler-与-kube-controller-manager-优化">kube-scheduler 与 kube-controller-manager 优化</h2>
<h3 id="高可用-1">高可用</h3>
<p>kube-controller-manager 和 kube-scheduler 是通过 leader election 实现高可用，启用时需要添加以下参数:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">--leader-elect<span style="color:#f92672">=</span>true
--leader-elect-lease-duration<span style="color:#f92672">=</span>15s
--leader-elect-renew-deadline<span style="color:#f92672">=</span>10s
--leader-elect-resource-lock<span style="color:#f92672">=</span>endpoints
--leader-elect-retry-period<span style="color:#f92672">=</span>2s
</code></pre></div><h3 id="控制-qps">控制 QPS</h3>
<p>与 kube-apiserver 通信的 qps 限制，推荐为：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">--kube-api-qps<span style="color:#f92672">=</span><span style="color:#ae81ff">100</span>
</code></pre></div><h2 id="集群-dns-高可用">集群 DNS 高可用</h2>
<p>设置反亲和，让集群 DNS (kube-dns 或 coredns) 分散在不同节点，避免单点故障:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#66d9ef">affinity</span>:
 <span style="color:#66d9ef">podAntiAffinity</span>:
   <span style="color:#66d9ef">requiredDuringSchedulingIgnoredDuringExecution</span>:
   - <span style="color:#66d9ef">weight</span>: <span style="color:#ae81ff">100</span>
     <span style="color:#66d9ef">labelSelector</span>:
       <span style="color:#66d9ef">matchExpressions</span>:
       - <span style="color:#66d9ef">key</span>: k8s-app
         <span style="color:#66d9ef">operator</span>: In
         <span style="color:#66d9ef">values</span>:
         - kube-dns
     <span style="color:#66d9ef">topologyKey</span>: kubernetes.io/hostname
</code></pre></div>

<footer class="footline">
	
</footer>

        
        </div> 
        

      </div>

    <div id="navigation">
        
        
        
        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
        
        


	 
	 
		
			<a class="nav nav-prev" href="/best-practice/deploy/scale-keepalive-service/" title="解决长连接服务扩容失效"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="/best-practice/shell/" title="实用命令与脚本" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>
    
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/js/clipboard.min.js?1583138100"></script>
    <script src="/js/perfect-scrollbar.min.js?1583138100"></script>
    <script src="/js/perfect-scrollbar.jquery.min.js?1583138100"></script>
    <script src="/js/jquery.sticky.js?1583138100"></script>
    <script src="/js/featherlight.min.js?1583138100"></script>
    <script src="/js/highlight.pack.js?1583138100"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/js/modernizr.custom-3.6.0.js?1583138100"></script>
    <script src="/js/learn.js?1583138100"></script>
    <script src="/js/hugo-learn.js?1583138100"></script>

    <link href="/mermaid/mermaid.css?1583138100" rel="stylesheet" />
    <script src="/mermaid/mermaid.js?1583138100"></script>
    <script>
        mermaid.initialize({ startOnLoad: true });
    </script>
    

  </body>
</html>

